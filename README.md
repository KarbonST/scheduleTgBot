																	
1. Архитектура, базирующаяся на конечном автомате																								
																								
	Конечный автомат описывает структуру переходов между "экранами" в процессе работы бота.																							
	Каждый узел конечного автомата описывает один экран, на котором у пользователя что-то запрашивают, или наоборот, — выдают какую-либо информацию.																							
	Переход к другому узлу конечного автомата (КА) выполняется по инициативе самого узла. Переход инициируется либо завершением работы узла, либо действием пользователя на текущем экране (в текущем узле КА) — вводом текста или нажатием на кнопку.																							
	Узел имеет возможность обработать реакцию пользователя перед тем как передать управление другому узлу.																							
	Узлы конечного автомата могут запрашивать и запоминать данные в некоторые ячейки памяти.																							
																								
	Для каждого пользователя будет храниться (в БД бота) текущее состояние конечного автомата и все данные, сохранённые в ходе работы с ботом (учитывая произвольную структуру хранящейся информации, в БД это будет JSON-строка).																							
	Из любого состояния можно попросить вернуться домой для быстрого доступа к основным функциям бота ( если передумали пользоваться одной функцией и решили воспользоваться другой, не доходя до завершения текущего процесса). Т.е.  кнопка "домой" будет всегда доступна по умолчанию.
  Однако узлы должны иметь право её отключать (переопределять поведение по умолчанию).																							
																								
	Должна быть возможность подключать (и отключать) новые "скиллы" — навыки — как независимые модули.																							
	Каждый скилл может добавлять свой кусочек конечного автомата в общую схему.																							
																								
	Каждый узел конечного автомата должен иметь уникальный идентификатор. Предлагаю называть его в иерархическом стиле: "myskill123.mynode456".																							
	Ячейка данных для хранения информации также должна иметь уникальный идентификатор: "myskill123.mynode456.mydata789". (Вместо словаря c полной строкой идентификатора может храниться в иерархическом словаре.)																							
																								
	Любые записанные данные о пользователе в ходе диалога с ним должны быть очищаемы при помощи кнопок типа "Выбрать другое", и/или через домашнее меню → "Управление контекcтом" (очистить контекст/историю) → выборочно сохранённые данные (перечисление пунктов), и "очистить весь контекст".																							
	Каждый скилл будет предоставлять пункт очистки "персональных данных" для домашнего меню, если он таковые собирает (пункт может быть пустым, если данные не были сохранены или были очищены).																							
																								
	В базовом варианте реализации чат-бота нужно заложить три скилла: поиск по группе, по преподавателю, по аудитории.
  В первых двух будет запоминаться последний выбор и использоваться в качестве текущего при следующем запросе; в третьем будет запоминаться история последних трёх-пяти поисков, с отсутствием повторов и сортировкой в порядке последнего использования.																							
																								
	Если пользователь ещё не выбирал ничего, то ему предлагается ввести имя или часть названия сущности,   по которому будет выполняться поиск (в справочнике ядра расписаний).																							
	Если пользователь выбирал нечто ранее, то этап выбора сущности по умолчанию пропускается, и процесс продолжается для выбранной ранее сущности, но на следующем этапе в обязательном порядке добавляется кнопка "другая группа" / "другой преподаватель" / "другая аудитория"
  для явного возврата на этап выбора сущности.																							
	При возврате на этап выбора сущности, пользователю сначала предлагается выбрать нечто из последних (если есть), а также ввести свой новый запрос.																							
	Свободнотекстовый ввод пользователя отправляется в ядро до поиска наиболее подходящей сущности.
  В случае среднего или низкого уровня уверенности в найденном результате (или при нескольких вариантах с высоким уровнем уверенности) пользователю отображаются наиболее вероятные варианты и предлагается выбрать один из них; также должна быть возможность ввести поисковый запрос заново.																							
																								
	Типовые варианты для выбора периода для отображения расписания:																							
	- сегодня																							
	- завтра (если на завтра ничего нет, то предложить послезавтра)																							
	- текущая неделя																							
	- следующая неделя.																							
																								
																								
3. "Краудсорсинг": Функции чат-бота для коллективного редактирования и актуализации расписания путём подтверждения несколькими другими пользователями.																								
																								
	Суть идеи: вместо того, чтобы самим коряво парсить (разбирать) данные из Excel-таблиц (а, может быть, и вместе с тем), —																							
	Можно позволить пользователям самим корректировать/наполнять данные для расписания. Например, исправлять ошибки или добавлять информацию, обычно не включённую в расписание (досдачи у конкретных преподавателей, перенос занятий в связи с праздниками или особыми мероприятиями в вузе).																							
																								
	Чтобы существенно снизить возможность внесения ошибочных и заведомо некорректных данных, предложения от одних пользователей будут проверяться путём задавания вопросов другим пользователям.
  При получении положительного вердикта от достаточного количества других пользователей предложение может быть принято и записано в основную БД как достоверные данные.																							
																								
																								
Каждому пользователю назначается уровень доверия, который учитывается при анализе:																								
	- предложений предложений от него,																							
	- реакций на чужие предложения.																							
																								
уровни:																								
* новичок (студент) — неизвестная личность, может пытаться вносить ерунду. Нужно проверять при помощи других (желательно незнакомых ему) лиц. Для принятия предложения требуется подтверждение от минимум трёх, лучше пяти новичков. Новичка нужно уведомить об ответственности за фальсификацию данных
и о публичном разглашении его поведения в случае, если это будет обнаружено. (Допустим бан на эту функцию за постоянный вред сообществу. Бан может быть ограничен по времени.)																								
* активный (любитель) — внёс уже немало информации и не склонен к её искажению. Может быть понижен до новичка в случае половины (и более) ложных предложений. Предложение считается принятым, если его подтвердили два активных пользователя.																								
* опытный — может ошибаться только по невнимательности; достаточно  подтверждения только от одного опытного для принятия предложения.																								
* администратор — не нуждается в подтверждениях (его вердикт не подлежит сомнению и дополнительному уточнению).																								
																								
Уровень пользователя не должен быть ему виден (равно как вердикты на его предложения и само их количество), но можно показать абстрактный числовой рейтинг, который будет постепенно расти при положительном вкладе 
(за каждое принятое предложение и чуть-чуть за каждый отклик, совпавший с мнением большинства откликнувшихся).																								
																								
При достижении определённого рейтинга или критериев мы переводим пользователя на более высокий уровень. Уровень администратора может быть назначен только другим администратором. Также администратор может задть любому пользователю любой уровень доверия по своему усмотрению.																								
Нужно предусмотреть возможность подтверждения акаунтов преподавателей ("Действительно ли аккаунт t.me/xyz принадлежит преподавателю ВолгГТУ Иванову С.С.?") так же через других пользователей. В случае успеха преподаватель сразу получает уровень "активного" с возможностью быстрого роста до "опытного".																								
																								
Пользователь может узнавать о том, что его предложение принято, отклонено, или ещё не проверено. Он может снять своё предложение с рассмотрения, а в случае отклонения подать повторно не более одного раза.																								
Также, предложение может стать неактульным, если расписание (исходные данные) изменилось, и теперь предлагаемое преобразование не является допустимым; такое возможно, если несколько желающих подали пересекающуюся информацию, и один подтвердил её раньше.																								
В случае же, если несколько пользователей независимо предложили одно и то же, дублирование идёт в зачёт подтвержаемости предложения (!но: это не должны быть исключительно участники одной учебной группы, нужно мнение и других, чтобы исключить сговор с целью обмануть систему доверия).																								
																								
Чтобы получать запросы на проверку чужих предложений, пользователь может разрешить боту отправлять ему сообщения с соответствующей просьбой о проверке анонимного предложения. 
Точнее, она будет ВКЛ по умолчанию, но при получении таких сообщений будет опция "не спрашивать меня", при выборе которой будет сообщение о том, что "ваш вклад очень нужен сообществу, ибо кто же, если не мы?" и повторное подтверждение: 
"вернуться к предложению", "спросить позже", "отказаться". После полного отказа можно снова начать получать просьбы, очистив свой отказ в домашнем меню о контексте.																								
																								
Получив просьбу, пользователь может выбрать следующие варианты:																								
	- верно, подтверждаю (принять)																							
	- неверно, не подтверждаю (отклонить)																							
	- неизвестно:																							
		- сейчас не могу ответить, напомнить позже																						
		- об этом ещё никто не знает (+ для странных случаев: уже неактуально)																						
		- у меня нет доступа к информации об этом																						
																								
Виды неизвестности помогут в планировании направления дальнейших вопросов об этом текущему пользователю и другим.																								
																								
Подавая предложение, нужно дополнительно указывать источник информации (типовые источники можно занести в локальный справочник для всех, чтобы не давать свободнотекстовый ввод, обнаруживающий автора предложения, который должен оставаться анонимным).																								
																								
Объекты, о которых можно вносить предложения о корректировке / добавлении / удалении:																								
																								
Элемент расписания:																								
	обновить преподавателя, место и время																							
	перенести занятие = удалить + добавить занятие																							
	добавить досдачи преподавателя (регулярное событие, как занятие)																							
	встречи в актовом зале и т.п. (разовые мероприятия)																							
																								
																								
Дни переносов из-за праздников, выходные дни в начале и конце семестра (точные даты границ семестра)																								
																								
Добавить экзамен																								
	изменить дату, место																							
																								
Добавить личное, приватное событие (не отображается ни у кого другого и не требует внешних подтверждений). 
Видно только создателю. Он также может удалить своё событие. Устаревшие (ушедшие в достаточно далёкое прошлое, например, больше года) личные события должны удаляться системой в целях очистки от мусора.																								
																								
																								
Публичные принятые предложения становятся частью расписания и удаляются вместе с ним.																								
																								
																								
* * *																								
